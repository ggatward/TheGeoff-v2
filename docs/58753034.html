<!DOCTYPE html>
<html>
    <head>
        <title>Jenkins SOE : Installing Jenkins (Master)</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Jenkins SOE</a></span>
                            </li>
                                                    <li>
                                <span><a href="Jenkins-Home_56197143.html">Jenkins Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Setup_58261522.html">Setup</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Jenkins SOE : Installing Jenkins (Master)
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Geoff Gatward</span>, last modified on Aug 12, 2017
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p><style type='text/css'>/*<![CDATA[*/
div.rbtoc1502524880072 {padding: 0px;}
div.rbtoc1502524880072 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1502524880072 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1502524880072'>
<ul class='toc-indentation'>
<li><a href='#InstallingJenkins(Master)-BuildOS'>Build OS</a></li>
<li><a href='#InstallingJenkins(Master)-InstallJenkins'>Install Jenkins</a></li>
<li><a href='#InstallingJenkins(Master)-InitialJenkinsLogin'>Initial Jenkins Login</a></li>
<li><a href='#InstallingJenkins(Master)-InstallJenkinsPlugins'>Install Jenkins Plugins</a>
<ul class='toc-indentation'>
<li><a href='#InstallingJenkins(Master)-Onlinemethod'>Online method</a></li>
<li><a href='#InstallingJenkins(Master)-Offlinemethod'>Offline method</a></li>
</ul>
</li>
<li><a href='#InstallingJenkins(Master)-ConfigureAuthenticationMethod'>Configure Authentication Method</a>
<ul class='toc-indentation'>
<li><a href='#InstallingJenkins(Master)-PosixLDAP'>Posix LDAP</a></li>
<li><a href='#InstallingJenkins(Master)-ActiveDirectory'>Active Directory</a></li>
<li><a href='#InstallingJenkins(Master)-IdM'>IdM</a></li>
</ul>
</li>
<li><a href='#InstallingJenkins(Master)-ConfigureProjectAuthorisation'>Configure Project Authorisation</a></li>
<li><a href='#InstallingJenkins(Master)-ConfigureGlobalParameters'>Configure Global Parameters</a></li>
<li><a href='#InstallingJenkins(Master)-EnablingHTTPSaccess'>Enabling HTTPS access</a></li>
<li><a href='#InstallingJenkins(Master)-CreateJenkinsSSHkeys'>Create Jenkins SSH keys</a></li>
<li><a href='#InstallingJenkins(Master)-SettingupCredentialStore'>Setting up Credential Store</a></li>
<li><a href='#InstallingJenkins(Master)-ConfiguringTools'>Configuring Tools</a></li>
<li><a href='#InstallingJenkins(Master)-ConfiguringWebhooksandGitIntegration'>Configuring Webhooks and Git Integration</a>
<ul class='toc-indentation'>
<li><a href='#InstallingJenkins(Master)-GitHub'>GitHub</a></li>
<li><a href='#InstallingJenkins(Master)-GitLab'>GitLab</a></li>
<li><a href='#InstallingJenkins(Master)-Bitbucket'>Bitbucket</a></li>
</ul>
</li>
</ul>
</div></p><h2 id="InstallingJenkins(Master)-BuildOS">Build OS</h2><p>If using a VM for Jenkins, it needs to have at least 4Gb RAM and 50Gb available in /var/lib/jenkins.</p><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>We are not covering the build of a VM for Jenkins here - once the machine is build with a basic RHEL 7 OS the following applies.</p></div></div><p>We need the following repositories enabled:</p><ul><li>RHEL 7 Server</li><li>RHEL 7 Server Optional</li><li>RHEL 7 Satellite Tools</li><li>EPEL 7</li><li>Jenkins  </li></ul><p>Assuming that we are getting content from Red Hat (CDN or Satellite):</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence"># subscription-manager repos --enable rhel-server-7-rpms --enable rhel-server-7-optional-rpms --enable rhel-7-server-satellite-6.2-rpms</pre>
</div></div><p>If we have an internet connection and can access EPEL/Jenkins directly:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence"># rpm --import https://pkg.jenkins.io/redhat/jenkins.io.key
# cat &lt;&lt; EOT &gt; /etc/yum.repos.d/jenkins.repo
[jenkins]
name=Jenkins
baseurl=http://pkg.jenkins.io/redhat
gpgcheck=1
EOT

# rpm --import https://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7
# cat &lt;&lt; EOT &gt; /etc/yum.repos.d/epel.repo
[jenkins]
name=EPEL
baseurl=https://dl.fedoraproject.org/pub/epel/7/x86_64
gpgcheck=1
EOT</pre>
</div></div><h2 id="InstallingJenkins(Master)-InstallJenkins"><br/>Install Jenkins</h2><p>Jenkins is built on Java, so requires a JRE to be installed. The default RHEL openjdk 1.8 works well and should be used.</p><p>Install the additional RPM's required for Jenkins and our specific project use case</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">yum -y install git nc java-1.8.0-openjdk jenkins ansible python2-pyvmomi python2-pip</pre>
</div></div><p>This project requires the use of 'pyshpere', which is not available as an RPM. To install this package we need to use the pip installer. We are setting the umask here as some base OS installations may have hardened this.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">umask 0022
pip install pysphere</pre>
</div></div><div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>In a disconnected environment without a PyPI mirror, you will need to download the pysphere source from <a href="https://github.com/argos83/pysphere/archive/master.zip" class="external-link" rel="nofollow">https://github.com/argos83/pysphere/archive/master.zip</a> and install it manually</p></div></div><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">unzip pysphere.zip
cd pysphere-master
python setup.py install</pre>
</div></div><p><br/></p><p>Enable and start the Jenkins service:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">systemctl enable jenkins
systemctl start jenkins</pre>
</div></div><p>Open port 8080 in the firewall:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">firewall-cmd --permanent --add-port 8080/tcp &amp;&amp; firewall-cmd --reload</pre>
</div></div><p><br/></p><h2 id="InstallingJenkins(Master)-InitialJenkinsLogin">Initial Jenkins Login</h2><p>Navigate to the Jenkins URL  <a href="http://jenkins.example.org/8080." class="external-link" rel="nofollow">http://jenkins.example.org/8080.</a>   On first login, you will be prompted to run through the initial setup wizard. Follow the wizard:</p><ul><li>Note the admin password in /var/lib/jenkins/secrets/initialAdminPassword - we will need this until authentication is set up.</li><li>Select the plugins to install - UNCHECK everything (i.e. no plugins)</li><li>Don't create a user - click 'continue as admin'</li></ul><h2 id="InstallingJenkins(Master)-InstallJenkinsPlugins">Install Jenkins Plugins</h2><p>For this project, the following plugins need to be installed.  Note that many of these plugins also have dependencies - using the online method below these dependencies will be automatically resolved.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">Active Directory plugin
Ansible plugin
AnsiColor
Bitbucket Plugin
Blue Ocean
build timeout plugin
Build Trigger Badge Plugin
Clone Workspace SCM Plugin
Email Extension Plugin
embeddable-build-status
GitLab Plugin
GitLab Hook Plugin
Green Balls
Groovy Postbuild
LDAP Plugin
Lockable Resources Plugin
Log Parser Plugin
Modern Status
Pipeline
Pipeline Utility Steps
SSH Slaves Plugin
TAP Plugin
Test Results Analyzer Plugin
vSphere Plugin
Workspace Cleanup Plugin</pre>
</div></div><p><span style="color: rgb(0,0,0);">Once the plugins have been installed, restart Jenkins.</span></p><h3 id="InstallingJenkins(Master)-Onlinemethod">Online method</h3><p>In a connected world, Jenkins will be able to connect to the Plugin mirrors and download/install plugins. Alternatively, a complete mirror of the plugin repository may be available inside the organisation.</p><p>If there is a proxy between the Jenkins server and the Internet, this needs to be configured as follows:</p><ul><li>In the Jenkins WebUI, navigate to Manage Jenkins → Plugin Manager, then click on the 'Advanced' tab.</li><li>Fill in the Server and Port details, and if required the Username/password for the proxy.</li></ul><p style="margin-left: 30.0px;"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="920" width="605" src="attachments/58753034/59047946.png?width=605" data-image-src="attachments/58753034/59047946.png" data-unresolved-comment-count="0" data-linked-resource-id="59047946" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="jksproxy.png" data-base-url="https://redhat-anzservices.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="58753034" data-linked-resource-container-version="36" data-media-id="1485055b-76c1-4ab9-8c81-1aaac58a45c0" data-media-type="file"></span></p><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>If the customer has a proxy with an ACL, the Jenkins server will need access to the following sites:</p><ul><li><pre>updates.jenkins-ci.org</pre></li><li><pre>mirrors.jenkins-ci.org</pre></li><li><pre>archives.jenkins-ci.org</pre></li><li><pre>ftp-chi.osuosl.org</pre></li><li><pre>ftp-nyc.osuosl.org</pre></li></ul></div></div><p><br/></p><p>With the proxy configured (if required), in the WebUI navigate to Manage Jenkins → Manage Plugins then select the 'Available' tab.</p><p>Place a tick in the checkbox next to each required plugin</p><p><br/></p><p><br/></p><p><br/></p><h3 id="InstallingJenkins(Master)-Offlinemethod">Offline method</h3><p>In some cases, Jenkins may have no way of connecting to a plugin server. In this case, it is easiest to install a Jenkins instance on a server with internet access, install the required plugins and then copy the /var/lib/jenkins/plugins  directory to the disconnected Jenkins server.</p><p><br/></p><p><br/></p><h2 id="InstallingJenkins(Master)-ConfigureAuthenticationMethod">Configure Authentication Method</h2><p>In the Jenkins WebUI, navigate to Manage Jenkins → Configure Global Security.</p><p>Depending on which authentication method is required, follow the relevent section below.</p><h3 id="InstallingJenkins(Master)-PosixLDAP">Posix LDAP</h3><p>In the 'Access Control - Security Realm' section, select the LDAP option and fill in the fields as shown. (In this case the Manager password is left blank - it is not required)</p><p><br/></p><h3 id="InstallingJenkins(Master)-ActiveDirectory">Active Directory</h3><p>In the 'Access Control - Security Realm' section, select the Active Directory option, then the 'Advanced' button and fill in the required fields.</p><p>Depending on the AD implementation, you may need to specify the Bind DN and Password of a user authorised to query AD</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="396" width="765" src="attachments/58753034/58884188.png?width=765" data-image-src="attachments/58753034/58884188.png" data-unresolved-comment-count="0" data-linked-resource-id="58884188" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="adauth.png" data-base-url="https://redhat-anzservices.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="58753034" data-linked-resource-container-version="36" data-media-id="7315579c-dbcd-4d65-a9a5-5b17ed4cb240" data-media-type="file"></span></p><p>Click the 'Test' button and confirm that connection to Active Directory is successful.</p><h3 id="InstallingJenkins(Master)-IdM">IdM</h3><p>If Red Hat IdM (IPA) is used as the authentication source, the following applies.</p><p><br/></p><h2 id="InstallingJenkins(Master)-ConfigureProjectAuthorisation">Configure Project Authorisation</h2><p>In the 'Access Control - Authorization' section, Select the 'Project-based Matrix Authorization Strategy' and populate the access table with the users/groups that will have global access to Jenkins.</p><p>Using this method, seperate projects can have thier own authorization.  Make sure that the Administrators have at least Read and Administrator access, or everyone will be locked out.</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="422" width="976" src="attachments/58753034/58818790.png?width=976" data-image-src="attachments/58753034/58818790.png" data-unresolved-comment-count="0" data-linked-resource-id="58818790" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="projauth.png" data-base-url="https://redhat-anzservices.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="58753034" data-linked-resource-container-version="36" data-media-id="7d35007d-aacd-4135-8751-788b74af353e" data-media-type="file"></span></p><p>At this point, you should be able to logout of the temporary local admin account and login with a corporately authenticated admin user.</p><h2 id="InstallingJenkins(Master)-ConfigureGlobalParameters">Configure Global Parameters</h2><p>A number of global parameters now need to be configured. In the WebUI, navigate to  Manage Jenkins → Configure System.</p><ul><li>In the 'Usage Statistics' section, untick the option 'Help make Jenkins better by sending anonymous usage statistics and crash reports to the Jenkins project'.</li><li>In the 'Jenkins Location' section, set the Admin email address to something appropriate.</li><li>In the 'Extended Email Notification' section, set the SMTP server and default user Email Suffix as required.</li><li>In the 'Email Notification' section, set the SMTP server and default user Email Suffix as required.</li><li>In the main section, set the Labels as 'master'<br/><br/></li></ul><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>One executor will be used for each action within the project. In this project we have several stages that run parallel tasks that build and test hosts. If all executors are busy, jobs will queue until an executor is available.</p><p>If the Jenkins server is shared with other projects it is recommended that a dedicated slave be configured with enough executors to handle all of the parallel activities, leaving the master node free to orchestrate this and other projects.</p></div></div><p class="auto-cursor-target">If the Jenkins Master server is going to be used to build this project, configure the options below. </p><ul><li class="auto-cursor-target">At the top of the main section, set the '# of executors' to be 2x the number of CPU cores on the host.</li><li class="auto-cursor-target">Set the 'Labels' to the string 'master, soe'<br/><br/></li></ul><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>This project can be configured so that Jenkins integrates directly with vCenter to power cycle VM's, or this can be performed via Jenkins → Satellite → vCenter integration.</p><p>If Jenkins &lt;&gt; vCenter integration is used, the vCenter credentials need to be stored in the Jenkins credential store.</p></div></div><p class="auto-cursor-target">If Jenkins is going to be integrating directly to vCenter, configure the options below.</p><ul><li>Under the 'Cloud' section, click 'Add a new cloud - vSphere cloud</li><li><span style="color: rgb(0,0,0);">The name of the cloud used in the pipeline is 'vcenter_server' - this must match here. Enter the vCenter hostname.</span><br/><span style="color: rgb(255,0,0);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="231" width="699" src="attachments/58753034/61079725.png?width=699" data-image-src="attachments/58753034/61079725.png" data-unresolved-comment-count="0" data-linked-resource-id="61079725" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="jksxx.png" data-base-url="https://redhat-anzservices.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="58753034" data-linked-resource-container-version="36" data-media-id="17e8047b-c236-43f7-8c10-ca71e455d287" data-media-type="file"></span></span></li><li>Next to Credentials, click the Add button, and select the Jenkins domain.</li><li>Enter the details for the vCenter credentials as shown. The 'ID' must be JenkinsVmw, as this is coded into the pipeline.<br/><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="398" width="603" src="attachments/58753034/59506726.png?width=603" data-image-src="attachments/58753034/59506726.png" data-unresolved-comment-count="0" data-linked-resource-id="59506726" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="jksvmw3.png" data-base-url="https://redhat-anzservices.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="58753034" data-linked-resource-container-version="36" data-media-id="0c8eeb47-c802-40ff-aa06-befa4f102228" data-media-type="file"></span></li><li>Click the Test Connection button and verify that the connection to vCenter is successful.</li></ul><p><br/></p><h2 id="InstallingJenkins(Master)-EnablingHTTPSaccess">Enabling HTTPS access</h2><p>By default Jenkins only accepts HTTP connections on port 8080. To enable secure connections over HTTPS the following steps need to be performed.</p><ul><li><p class="auto-cursor-target">Create a new SSL certificate for Jenkins. The example below is self-signed, but a corporately signed certificate should be a similar process.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence"># Generate a new self-signed certificate
openssl req -x509 -newkey rsa:2048 -keyout /etc/pki/tls/private/jenkins.key -out /etc/pki/tls/certs/jenkins.pem -days 3650

# Bundle the key and cert into a pkcs12 bundle
openssl pkcs12 -inkey /etc/pki/tls/private/jenkins.key -in /etc/pki/tls/certs/jenkins.pem -export -out /etc/pki/tls/certs/jenkins.pkcs12

# Create the Java keystore
keytool -importkeystore -srckeystore /etc/pki/tls/certs/jenkins.pkcs12 -destkeystore /etc/pki/java/jenkins.jks
chmod 644 /etc/pki/java/jenkins.jks</pre>
</div></div></li><li><p class="auto-cursor-target">Next, modify the Jenkins configuration to use the certificates. Config file is /etc/sysconfig/jenkins - these parameters will be in the default config but will not be populated.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">JENKINS_HTTPS_PORT=&quot;8443&quot;
JENKINS_HTTPS_KEYSTORE=&quot;/etc/pki/java/jenkins.jks&quot;
JENKINS_HTTPS_KEYSTORE_PASSWORD=&quot;*********&quot;
JENKINS_HTTPS_LISTEN_ADDRESS=&quot;0.0.0.0&quot;</pre>
</div></div></li><li><p class="auto-cursor-target">Restart Jenkins and verify it is now listening on port 8443</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence"># systemctl restart jenkins
# netstat -tnlp | grep 8443
tcp     0     0 0.0.0.0:8443        0.0.0.0:*         LISTEN     24108/java</pre>
</div></div></li><li><p class="auto-cursor-target">Allow port 8443 through the firewall, and remove port 8080 (unless unencrypted HTTP access is still required)</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">firewall-cmd --permanent --add-port 8443/tcp
firewall-cmd --permanent --remove-port 8080/tcp
firewall-cmd --reload</pre>
</div></div></li><li><p class="auto-cursor-target">In the WebUI, navigate to Manage Jenkins → Configure System.  Change the Jenkins URL under the 'Jenkins Location' section to the HTTPS URI and port.</p></li></ul><h2 id="InstallingJenkins(Master)-CreateJenkinsSSHkeys">Create Jenkins SSH keys</h2><p>Jenkins uses SSH to communicate with Jenkins slaves as well as to other servers such as Git and Satellite to perform tasks related to the project pipeline. To allow this interaction the 'jenkins' user needs to have SSH keys created to allow passwordless login to those services.</p><ul><li><p class="auto-cursor-target">On the OS, su to the jenkins user and use ssh-keygen to generate an ssh keypair - do not enter a passphrase.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">su - jenkins -s /bin/bash
ssh-keygen -t rsa</pre>
</div></div></li></ul><ul><li><p class="auto-cursor-target">Push the Jenkins SSH keys to all slaves</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">su - jenkins -s /bin/bash
ssh-copy-id &lt;slave FQDN&gt;</pre>
</div></div></li></ul><h2 id="InstallingJenkins(Master)-SettingupCredentialStore">Setting up Credential Store</h2><p>To avoid saving and sending plain-text passwords, we make use of the Jenkins credential store. Once in the store, passwords are able to be referenced and are passed to jobs in hashed formats.</p><ul><li>In the Jenkins WebUI, navigate to Credentials → System → Global credentials (unrestricted)</li><li>Click Add Credentials, then set the 'kind' to 'SSH Username with private key'.  Fill in the details as below and save the record.<br/><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="445" width="628" src="attachments/58753034/59211780.png?width=628" data-image-src="attachments/58753034/59211780.png" data-unresolved-comment-count="0" data-linked-resource-id="59211780" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="jks1.png" data-base-url="https://redhat-anzservices.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="58753034" data-linked-resource-container-version="36" data-media-id="c3eabfca-46d5-482d-8feb-e72ac428199e" data-media-type="file"></span><br/><br/></li><li>Navigate to Credentials → System → Add domain.  Create a new domain called 'RHEL SOE'.</li><li><p class="auto-cursor-target">Within the RHEL SOE domain, click 'Add Credentials' and add a 'Username with Password' type with the following settings  (Set the desired root password for the hosts)</p><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>This is the root password used by Jenkins to access the build test hosts, and must match the root password defined in Satellite for the SOE Host Groups. The ID is used internally by the pipeline and must be set as shown.</p></div></div><p class="auto-cursor-target"><br/><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="355" width="628" src="attachments/58753034/59047996.png?width=628" data-image-src="attachments/58753034/59047996.png" data-unresolved-comment-count="0" data-linked-resource-id="59047996" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="jks3.png" data-base-url="https://redhat-anzservices.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="58753034" data-linked-resource-container-version="36" data-media-id="e85d857f-9522-4518-886f-9ea534d866c3" data-media-type="file"></span></p></li></ul><h2 id="InstallingJenkins(Master)-ConfiguringTools">Configuring Tools</h2><p>This Jenkins project makes use of Ansible to execute some of the calls between Jenkins and other platforms. In order for Jenkins to do this, we need to configure the Ansible tool within Jenkins.</p><p>In the WebUI, navigate to Manage Jenkins → Global Tool Configuration</p><p>In the 'Ansible' section, click 'Add Ansible', then fill in the details:</p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" src="attachments/58753034/59342906.png" data-image-src="attachments/58753034/59342906.png" data-unresolved-comment-count="0" data-linked-resource-id="59342906" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="jksans.png" data-base-url="https://redhat-anzservices.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="58753034" data-linked-resource-container-version="36" data-media-id="d19cc051-7fe1-4fbe-96b9-5088b23ad81b" data-media-type="file"></span></p><h2 id="InstallingJenkins(Master)-ConfiguringWebhooksandGitIntegration">Configuring Webhooks and Git Integration</h2><p>In order to integrate with the Git repository using webhooks, Jenkins needs some configuration, depending on the Git server being used.</p><h3 id="InstallingJenkins(Master)-GitHub">GitHub</h3><p><br/></p><h3 id="InstallingJenkins(Master)-GitLab">GitLab</h3><p><br/></p><p><br/></p><p><br/></p><h3 id="InstallingJenkins(Master)-Bitbucket">Bitbucket</h3><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/58753034/58884188.png">adauth.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/58753034/58818790.png">projauth.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/58753034/59047946.png">jksproxy.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/58753034/59211780.png">jks1.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/58753034/59047991.png">jks2.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/58753034/59047996.png">jks3.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/58753034/59211794.png">jksv1.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/58753034/59310093.png">jksv2.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/58753034/59342906.png">jksans.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/58753034/59605012.png">jksvmw.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/58753034/59932673.png">jksvmw2.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/58753034/59506726.png">jksvmw3.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/58753034/61079720.png">jkswbhk1.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/58753034/61505569.png">jkswebhk2.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/58753034/61079725.png">jksxx.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/58753034/64487500.png">wh3.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/58753034/64618692.png">gl01.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/58753034/64651532.png">gl002.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Aug 12, 2017 18:01</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
